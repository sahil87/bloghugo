<!DOCTYPE HTML>

<html>
    <head>
        
            
                <title>Mail with postfix and ldap</title>
            
        

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="generator" content="Hugo 0.29" />
        


        
            <meta name="author" content="Sahil Ahuja">
        
        
            
                <meta name="description" content="One day at a time. One problem at a time.">
            
        

        <meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Mail with postfix and ldap"/>
<meta name="twitter:description" content="Yes, it&rsquo;s possible. I did it for the pragyan.org server.
The setup we used was :
 /var/mail/virtual/%u: the inboxes of different users, /var/mail/virtual/PragyanMail/%u/%f: the different folders in mailboxes of different users.  It&rsquo;s much easily setup than one thinks initially.
HOW?? Here&rsquo;s how:
But, as with anything else, basics first
 SMTP server : Simple Mail Transfer Protocol : The server which sends and receives mails. Postfix (or smtp)."/>
<meta name="twitter:site" content="@_sahilahuja"/>

        <meta property="og:title" content="Mail with postfix and ldap" />
<meta property="og:description" content="Yes, it&rsquo;s possible. I did it for the pragyan.org server.
The setup we used was :
 /var/mail/virtual/%u: the inboxes of different users, /var/mail/virtual/PragyanMail/%u/%f: the different folders in mailboxes of different users.  It&rsquo;s much easily setup than one thinks initially.
HOW?? Here&rsquo;s how:
But, as with anything else, basics first
 SMTP server : Simple Mail Transfer Protocol : The server which sends and receives mails. Postfix (or smtp)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://www.sahil.cc/post/2008/mail-with-postfix-and-ldap/" />



<meta property="article:published_time" content="2008-05-03T08:39:43&#43;00:00"/>
<meta property="article:modified_time" content="2008-05-03T08:39:43&#43;00:00"/>











        
<meta itemprop="name" content="Mail with postfix and ldap">
<meta itemprop="description" content="Yes, it&rsquo;s possible. I did it for the pragyan.org server.
The setup we used was :
 /var/mail/virtual/%u: the inboxes of different users, /var/mail/virtual/PragyanMail/%u/%f: the different folders in mailboxes of different users.  It&rsquo;s much easily setup than one thinks initially.
HOW?? Here&rsquo;s how:
But, as with anything else, basics first
 SMTP server : Simple Mail Transfer Protocol : The server which sends and receives mails. Postfix (or smtp).">


<meta itemprop="dateModified" content="2008-05-03T08:39:43&#43;00:00" />
<meta itemprop="wordCount" content="1099">



<meta itemprop="keywords" content="dovecot,fedora,ldap,mail,postfix," />

        

        
            
        

        
        
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">
            <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,800,900|Source+Sans+Pro:400,700">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.css">
            <link rel="stylesheet" href="http://www.sahil.cc/css/main.css">
            <link rel="stylesheet" href="http://www.sahil.cc/css/add-on.css">
        

        
            
                
            
                
                    <link rel="stylesheet" href="http://www.sahil.cc/css/syntax.css">
                
            
                
                    <link rel="stylesheet" href="http://www.sahil.cc/css/bugfix.css">
                
            
        

        
            
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-87967706-1', 'auto');
ga('send', 'pageview');
</script>

        
    </head>
    <body>

      
      <div id="wrapper">

    
    
<header id="header">
    
      <h1><a href="http://www.sahil.cc/">post</a></h1>
    

    <nav class="links">
        <ul>
            
                <li>
                    <a href="http://www.sahil.cc/">
                            <i class="fa fa-home">&nbsp;</i>Home
                    </a>
                </li>
            
                <li>
                    <a href="http://www.sahil.cc/about/">
                            <i class="fa fa-id-card-o">&nbsp;</i>About
                    </a>
                </li>
            
                <li>
                    <a href="http://www.sahil.cc/quotes/">
                            <i class="fa fa-list">&nbsp;</i>Quotes
                    </a>
                </li>
            
                <li>
                    <a href="http://www.sahil.cc/categories/">
                            <i class="fa fa-sitemap">&nbsp;</i>Categories
                    </a>
                </li>
            
                <li>
                    <a href="https://gmetri.com/">
                            <i class="fa fa-newspaper-o">&nbsp;</i>GMETRI
                    </a>
                </li>
            
                <li>
                    <a href="http://www.sahil.cc/contact/">
                            <i class="fa fa-envelope-o">&nbsp;</i>Contact
                    </a>
                </li>
            
        </ul>
    </nav>
    <nav class="main">
        <ul>
            
            <li id="share-nav" class="share-menu" style="display:none;">
                <a class="fa-share-alt" href="#share-menu">Share</a>
            </li>
            
            <li class="search">
                <a class="fa-search" href="#search">Search</a>
                <form id="search" method="get" action="//google.com/search">
                    <input type="text" name="q" placeholder="Search" />
                    <input type="hidden" name="as_sitesearch" value="http://www.sahil.cc">
                </form>
            </li>
            <li class="menu">
                <a class="fa-bars" href="#menu">Menu</a>
            </li>
        </ul>
    </nav>
</header>


<section id="menu">

    
        <section>
            <form class="search" method="get" action="//google.com/search">
                <input type="text" name="q" placeholder="Search" />
                <input type="hidden" name="as_sitesearch" value="http://www.sahil.cc">
            </form>
        </section>

    
        <section>
            <ul class="links">
                
                    <li>
                        <a href="http://www.sahil.cc/">
                            <h3>
                                <i class="fa fa-home">&nbsp;</i>Home
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="http://www.sahil.cc/about/">
                            <h3>
                                <i class="fa fa-id-card-o">&nbsp;</i>About
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="http://www.sahil.cc/quotes/">
                            <h3>
                                <i class="fa fa-list">&nbsp;</i>Quotes
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="http://www.sahil.cc/categories/">
                            <h3>
                                <i class="fa fa-sitemap">&nbsp;</i>Categories
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="https://gmetri.com/">
                            <h3>
                                <i class="fa fa-newspaper-o">&nbsp;</i>GMETRI
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="http://www.sahil.cc/contact/">
                            <h3>
                                <i class="fa fa-envelope-o">&nbsp;</i>Contact
                            </h3>
                        </a>
                    </li>
                
            </ul>
        </section>

    
        <section id="recent-posts">
            <div class="mini-posts">
                <header>
                    <h3>Recent Posts</h3>
                </header>
                

                
                    
                

                
                        <article class="mini-post">
                            <header>
                                <h3><a href="http://www.sahil.cc/post/2017/switching-from-hexo-to-hugo/">Switching From Hexo to Hugo</a></h3>
                                
                                <time class="published" datetime=
                                    '2017-10-18'>
                                    October 18, 2017</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="http://www.sahil.cc/post/2017/typing-unicode-characters-in-ubuntu/">Typing Unicode Characters in Ubuntu</a></h3>
                                
                                <time class="published" datetime=
                                    '2017-08-27'>
                                    August 27, 2017</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="http://www.sahil.cc/post/2017/tracking-hostname-in-google-analytics/">Tracking hostname in Google Analytics</a></h3>
                                
                                <time class="published" datetime=
                                    '2017-03-28'>
                                    March 28, 2017</time>
                            </header>
                            
    

    
        
        






    


        
        
        

        <a href="http://www.sahil.cc/post/2017/tracking-hostname-in-google-analytics/" class="image featured">
            <img src="http://www.sahil.cc/images/2017/google_analytics_filter.png" alt="" style='height: 100%; width: 300px; object-fit: contain; margin: auto;'>
        </a>
    


                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="http://www.sahil.cc/post/2017/to-frame-or-not-to-frame/">To Frame or Not to Frame</a></h3>
                                
                                <time class="published" datetime=
                                    '2017-03-01'>
                                    March 1, 2017</time>
                            </header>
                            

                        </article>
                

                
                    <a href=
                        
                            /post/
                        
                        class="button">View more posts</a>
                
            </div>
        </section>

    
        
</section>

    <section id="share-menu">
    <section id="social-share-nav">
        <ul class="links">
            <header>
                <h3>Share this post <i class="fa fa-smile-o"></i></h3>
            </header>
            


<li>
  <a href="//twitter.com/share?url=http%3a%2f%2fwww.sahil.cc%2fpost%2f2008%2fmail-with-postfix-and-ldap%2f&text=Mail%20with%20postfix%20and%20ldap&via=_sahilahuja" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
    </a>
</li>



  
    
    
  



<li>
  <a href="//www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fwww.sahil.cc%2fpost%2f2008%2fmail-with-postfix-and-ldap%2f" target="_blank" class="share-btn facebook">
    <i class="fa fa-facebook"></i>
    <p>Facebook</p>
    </a>
</li>


<li>
  <a href="//reddit.com/submit?url=http%3a%2f%2fwww.sahil.cc%2fpost%2f2008%2fmail-with-postfix-and-ldap%2f&title=Mail%20with%20postfix%20and%20ldap" target="_blank" class="share-btn reddit">
    <i class="fa fa-reddit-alien"></i>
    <p>Reddit</p>
  </a>
</li>


<li>
  <a href="//www.linkedin.com/shareArticle?url=http%3a%2f%2fwww.sahil.cc%2fpost%2f2008%2fmail-with-postfix-and-ldap%2f&title=Mail%20with%20postfix%20and%20ldap" target="_blank" class="share-btn linkedin">
      <i class="fa fa-linkedin"></i>
      <p>LinkedIn</p>
    </a>
</li>



  
    
    
  




  
    
    
  



<li>
  <a href="mailto:?subject=Check out this post by Sahil%20Ahuja&body=http%3a%2f%2fwww.sahil.cc%2fpost%2f2008%2fmail-with-postfix-and-ldap%2f" target="_blank" class="share-btn email">
    <i class="fa fa-envelope"></i>
    <p>Email</p>
  </a>
</li>

        </ul>
    </section>
</section>

    
    <div id="main">
        
        
        <article class="post">
  <header>
    <div class="title">
        
            <h1><a href="http://www.sahil.cc/post/2008/mail-with-postfix-and-ldap/">Mail with postfix and ldap</a></h1>
            
        
        
    </div>
    <div class="meta">
        

        <time class="published"
            datetime='2008-05-03'>
            May 3, 2008</time>
        <span class="author">Sahil Ahuja</span>
        
            <p>6 minute read</p>
        
        
    </div>
</header>


  
    <section id="social-share">
      <ul class="icons">
        


<li>
  <a href="//twitter.com/share?url=http%3a%2f%2fwww.sahil.cc%2fpost%2f2008%2fmail-with-postfix-and-ldap%2f&text=Mail%20with%20postfix%20and%20ldap&via=_sahilahuja" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
    </a>
</li>



  
    
    
  



<li>
  <a href="//www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fwww.sahil.cc%2fpost%2f2008%2fmail-with-postfix-and-ldap%2f" target="_blank" class="share-btn facebook">
    <i class="fa fa-facebook"></i>
    <p>Facebook</p>
    </a>
</li>


<li>
  <a href="//reddit.com/submit?url=http%3a%2f%2fwww.sahil.cc%2fpost%2f2008%2fmail-with-postfix-and-ldap%2f&title=Mail%20with%20postfix%20and%20ldap" target="_blank" class="share-btn reddit">
    <i class="fa fa-reddit-alien"></i>
    <p>Reddit</p>
  </a>
</li>


<li>
  <a href="//www.linkedin.com/shareArticle?url=http%3a%2f%2fwww.sahil.cc%2fpost%2f2008%2fmail-with-postfix-and-ldap%2f&title=Mail%20with%20postfix%20and%20ldap" target="_blank" class="share-btn linkedin">
      <i class="fa fa-linkedin"></i>
      <p>LinkedIn</p>
    </a>
</li>



  
    
    
  




  
    
    
  



<li>
  <a href="mailto:?subject=Check out this post by Sahil%20Ahuja&body=http%3a%2f%2fwww.sahil.cc%2fpost%2f2008%2fmail-with-postfix-and-ldap%2f" target="_blank" class="share-btn email">
    <i class="fa fa-envelope"></i>
    <p>Email</p>
  </a>
</li>

      </ul>
    </section>
  

  

  <div id="content">
    

<p>Yes, it&rsquo;s possible. I did it for the <a href="http://pragyan.org">pragyan.org</a> server.</p>

<p>The setup we used was :</p>

<ul>
<li><code>/var/mail/virtual/%u</code>: the inboxes of different users,</li>
<li><code>/var/mail/virtual/PragyanMail/%u/%f</code>: the different folders in mailboxes of different users.</li>
</ul>

<p>It&rsquo;s much easily setup than one thinks initially.</p>

<p>HOW?? Here&rsquo;s how:</p>

<p><em>But</em>, as with anything else, basics first</p>

<ul>
<li><p><a href="http://en.wikipedia.org/wiki/SMTP"><acronym title="Simple Mail Transfer Protocol">SMTP</acronym></a> server : Simple Mail Transfer Protocol : The server which sends and receives mails. <strong>Postfix (or smtp)</strong>.</p></li>

<li><p><a href="http://en.wikipedia.org/wiki/IMAP"><acronym title="Internet Message Access Protocol">IMAP</acronym></a> server : Internet Message Access Protocol : The service which interacts with the <acronym title="Simple Mail Transfer Protocol">SMTP</acronym> server to access mail and send mail. <strong>Dovecot</strong></p></li>

<li><p>These come preinstalled in most linux distributions.</p></li>
</ul>

<p>Apart from these, other tricks that can be used by people to confuse simple minded, bread earning people like us are :</p>

<ul>
<li><a href="http://en.wikipedia.org/wiki/Mail_transfer_agent">MTA</a> : Mail transfer agent : A <a href="http://en.wikipedia.org/wiki/Computer_program" title="Computer program">computer program</a> or <a href="http://en.wikipedia.org/wiki/Software_agent" title="Software agent">software agent</a> that transfers <a href="http://en.wikipedia.org/wiki/Electronic_mail" title="Electronic mail">electronic mail</a> messages from one computer to another. (Eg: <a href="http://www.postfix.org/">Postfix</a>, <a href="http://www.sendmail.org/">Sendmail</a>)</li>
<li><a href="http://en.wikipedia.org/wiki/Mail_delivery_agent">MDA</a> : Mail delivery agent : A <strong>Mail Delivery Agent</strong> (<strong>MDA</strong>) is <a href="http://en.wikipedia.org/wiki/Software" title="Software">software</a> that delivers <a href="http://en.wikipedia.org/wiki/E-mail" title="E-mail">e-mail</a> messages right after they&rsquo;ve been accepted on a server, distributing them to recipients&rsquo; individual <a href="http://en.wikipedia.org/wiki/Email_Mailbox" title="Email Mailbox">mailboxes</a>. (Eg: <a href="http://www.dovecot.org/">dovecot</a>)</li>
<li><a href="http://en.wikipedia.org/wiki/Mail_user_agent">MUA</a> : Mail user agent : An <strong>e-mail client</strong>, aka <strong>Mail User Agent</strong> (MUA), aka <strong>email reader</strong> is a frontend <a href="http://en.wikipedia.org/wiki/Computer_program" title="Computer program">computer program</a> used to manage <a href="http://en.wikipedia.org/wiki/Email" title="Email">email</a>. (Eg: <a href="http://gmail.com">gmail</a>, <a href="http://gnome.org/projects/evolution/">evolution</a>, <a href="http://www.horde.org/">horde</a>, <a href="http://squirrelmail.org/">squirrelmail</a>, Outlook Express.)
Now that thats out of the way, lets get our hands dirty.</li>
</ul>

<p>But again, not so fast. As with anything in linux, when you set off to configure something, you end up knowing much more than you bargained for. ;)</p>

<h3 id="a-id-aliases-name-aliases-aliases-a"><a id="aliases" name="aliases">Aliases</a></h3>

<p>Aliases are mappings between one source name and one or many destination name (in mail).</p>

<p>Aliases can be found out from flat files in the form of mapping, from sql queries or from ldap (<code>man ldap_table</code>). The source itself can be in the destination.</p>

<p>Link to alias files is given in <code>/etc/postfix/main.cf</code> at line
<code>alias_maps = hash:/etc/aliases, ldap:/etc/postfix/ldap-aliases.cf</code></p>

<p>Type <code>/usr/sbin/postmap -q core@pragyan.org ldap:/etc/postfix/ldap-aliases.cf</code> to see its effects.</p>

<h3 id="a-id-local-transport-name-local-transport-local-transport-a"><a id="local_transport" name="local_transport">local_transport</a></h3>

<p>The <em>local_transport</em> parameter corresponds to the mail delivery agent used.</p>

<ol>
<li><p>The default with postfix is <em>local</em>. The problem with local is that is requires local users and hence, a posixAccount schema to be an objectClass of every mail account. Rejected. Btw local also has to ability of mail forwarding to a user. i.e. if mailbox of <strong><em>user</em></strong> user1 is user1@gmail.com (user forwarding), then local will also forward to user1@gmail.com. By default, it assumes the uid of the user it is delivering mail to while delvering mail.</p></li>

<li><p>Next is <em>virtual</em>. This is the one used. Virtual accepts users who are <em>system</em> users. But virtual (for security purposes) does not forward to hosts other than the localhost. So how do we forward to external hosts? virtual forwards in case the mails are aliases. So we simply put the gmail address as the entry of one of the aliases of the mail. If virtual MDA is used then whose uid does it use? (because the uid of the user himself doesn’t exist on the system). Another parameter value has to be used :</p>

<pre><code>virtual_minimum_uid = 100 (security feature)
virtual_uid_maps = static:700
virtual_gid_maps = static:700
</code></pre></li>

<li><p>Other mail delivery agents : <em>procmail</em> doesn’t understand LDAP, and <em>maildrop</em> has too much overhead.</p></li>
</ol>

<h3 id="a-id-group-expansion-name-group-expansion-group-expansion-a"><a id="group_expansion" name="group_expansion">Group expansion</a></h3>

<p>Excellent notes are available in /usr/share/doc/postfix-2.4.3/README_FILES/LDAP_README.</p>

<p>Any “map” parameter value, like alias_maps, can be either given a flat mapping file name, or a .cf file, with tells it what to do to get the mapping, in this format : <strong>protocol:filename</strong>. Eg.</p>

<p><code>virtual_mailbox_maps = ldap:/etc/postfix/accountsmap.cf</code></p>

<h3 id="a-id-mail-boxes-name-mail-boxes-mail-boxes-a"><a id="mail_boxes" name="mail_boxes">Mail boxes</a></h3>

<p><strong>mbox</strong> is a format for storing mails. It is the default format used in postfix and dovecot. This is a line from dovecot conf :
<code>mail_location = mbox:/var/spool/mail/virtual/PragyanMail/%u:INBOX=/var/spool/mail/virtual/%u</code></p>

<p>The first part (mbox:<strong>/var/spool/mail/virtual/PragyanMail/</strong>%u:INBOX=/var/spool/mail/virtual/%u) refers to the user’s mail folder, which contains all his mail folders (Trash, drafts, sent mail.. ) (<em>the user’s mail folders are files in mbox format</em>)</p>

<p>The second part (mbox:/var/spool/mail/virtual/PragyanMail/%u:INBOX=<strong>/var/spool/mail/virtual/%u</strong>) refers to the one specific user folder (i.e. server file) which postfix writes to, that is his INBOX. (All other folders are written to and handled by the <acronym title="Internet Message Access Protocol">IMAP</acronym> client - dovecot.) Other variables which could have been used for specifying this are : %u - username, %n - user part in user@domain, same as %u if there’s no domain, %d - domain part in user@domain, %h - home directory etc.</p>

<p>A virtual user can specify his mail folder to be anywhere. So, the following is a security config for postfix INBOX files :</p>

<p><code>virtual_mailbox_base = /var/spool/mail/virtual</code></p>

<p>Also <code>chmod g+s /usr/bin/procmail</code> for it to be able to create mail directories</p>

<h3 id="a-id-maps-specified-in-postfix-name-maps-specified-in-postfix-maps-specified-in-postfix-a"><a id="maps_specified_in_postfix" name="maps_specified_in_postfix">Maps specified in postfix</a></h3>

<p>Maps are specified in <code>/etc/postfix/main.cf</code>. Important maps to be specified are :</p>

<ol>
<li>User aliases <strong>virtual_alias_maps</strong> - mapping between group@domain.org and user1@pragyan.org, user2@pragyan.org, &hellip;</li>
<li>User mailboxes <strong>virtual_mailbox_maps</strong> - mapping between mailaddress (user1@pragyan.org) and mailbox location (<code>/var/spool/mail/virtual/user1</code>). A confirmation that the mail address corresponds to a real virtual user. For mail to be delivered, this entry needs to be there, which contains the mailbox address. This is but only a one to one mapping. (Ignores all following values)
<code>local_recipient_maps = $virtual_mailbox_maps</code>
This line is required whenever the <strong>local_transport</strong> is changed to something else. (in this case to virtual)</li>
</ol>

<h3 id="a-id-schemas-the-real-working-name-schemas-the-real-working-schemas-the-real-working-a"><a id="schemas_the_real_working" name="schemas_the_real_working">Schemas (The Real Working):</a></h3>

<ul>
<li>Ldap Entry <strong>evolutionPersonList</strong><pre>
contact (multiple) : links to others ldap entries : uid=sahil,ou=P&hellip; , uid=cyber, ou=.. , &hellip;
mail (multiple) : mails : sahilahuja@gmail.com, core@pragyan.org, &hellip;
listName (single) : list name : coding
</pre></li>

<li><p>main.cf entry : <code>virtual_alias_maps = ldap:/etc/postfix/ldap-aliases.cf</code>. Contents of ldap-aliases.cf :</p>
<div class="highlight"><pre class="chroma"><code class="language-toml" data-lang="toml"><span class="s1f40">server_host = 10.0.0.126
</span><span class="s1f40">search_base = ou=Groups,ou=Pragyan,dc=delta,dc=nitt.edu
</span><span class="s1f40">query_filter = (&amp;(objectClass=*)(listName=%u))
</span><span class="s1f40">result_attribute = mail
</span><span class="s1f40">special_result_attribute = contact
</span><span class="s1f40">bind = yes
</span><span class="s1f40">bind_dn = cn=dovecot,ou=Pragyan,dc=delta,dc=nitt.edu
</span><span class="s1f40">bind_pw = ******</span></code></pre>
</div>
<ul>
<li>The field matched is <strong>listName</strong>.</li>
<li>The query runs recursively runs on field “contact”.</li>
<li>All mails of form alias@pragyan.org again go through the same process.</li>
</ul></li>

<li><p>Ldap entry <strong>evolutionPerson</strong> . Important thing in it is the mapping between uid and mail. It’s a proof to postfix the user is a real virtual user.</p></li>

<li><p>main.cf entry <code>virtual_mailbox_maps = ldap:/etc/postfix/accountsmap.cf</code>. Contents of accountsmap.cf :</p>
<div class="highlight"><pre class="chroma"><code class="language-toml" data-lang="toml"><span class="s1f40">server_host = 10.0.0.126
</span><span class="s1f40">search_base = ou=People,ou=Pragyan,dc=delta,dc=nitt.edu
</span><span class="s1f40">query_filter = (&amp;(objectClass=*)(mail=%s))
</span><span class="s1f40">result_attribute = uid
</span><span class="s1f40">bind = yes
</span><span class="s1f40">bind_dn = cn=dovecot,ou=Pragyan,dc=delta,dc=nitt.edu
</span><span class="s1f40">[gallery]bind_pw = ******</span></code></pre>
</div></li>

<li><p>The final main.cf entry that fits it all : virtual_mailbox_base = /var/spool/mail/virtual . A file with the name that is a result of the previous query (<strong>uid</strong>), gets created in this directory as the inbox of the user.
Workflow is mailid → getaliases → Use alias result to get mail ids → deliver. That is, first alaises get processed, then accountsmap.</p></li>
</ul>

<p>Here are the files I used finally :</p>

<ul>
<li>Postfix : <span class="wikilink1">main.cf</span>, <span class="wikilink1">accountsmap.cf</span>, <span class="wikilink1">ldap-alias.conf</span></li>
<li>Dovecot : <span class="wikilink1">dovecot.conf</span>, <span class="wikilink1">dovecot-ldap.conf</span></li>
<li><a href="https://gist.github.com/sahil87/fe2569f472cccaa1c277aefc2c2ff245">Here</a> is a compilation of the final content of these files.</li>
</ul>

<p><a href="http://wanderingbarque.com/howtos/mailserver/mailserver.html">Here</a> is the link of the guide I used as my own reference.</p>

  </div>
  <footer>
    <ul class="stats">
    
        

        
        
            <li>
                
                
                    

                    

                    
                        <i class="fa fa-sitemap">&nbsp;</i>
                    

                    
                        Category
                    
                
            </li>
        
    

    
    
        <li><a href='http://www.sahil.cc/categories/nitt'>nitt</a></li>
    
</ul>

  </footer>
  <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "sahil-cc" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</article>
<ul class="actions pagination">
    
        <li><a href="http://www.sahil.cc/post/2008/final-report-and-files/"
                class="button big previous">Final report and files</a></li>
    

    
        <li><a href="http://www.sahil.cc/post/2008/public-html-web-server-without-mod-userdir/"
                class="button big next">public_html web server - without mod_userdir</a></li>
    
</ul>


    </div>
    
<section id="sidebar">

  
  <section id="intro">
    
    
      
        <img src="http://www.sahil.cc/img/avatar.png" width="105" alt="Coder Dojo">
      
    
    
      <header>
        <h2>Sahil Ahuja</h2>
        <p>~ Keep It Simple & Stupid ~ <i class='fa fa-hand-peace-o'></i></p>
      </header>
    
    
      <ul class="icons">
        
        
  <li><a href="//github.com/sahil87" target="_blank" title="GitHub" class="fa fa-github"></a></li>





  <li><a href="//stackoverflow.com/users/1233476" target="_blank" title="Stack Overflow" class="fa fa-stack-overflow"></a></li>











  <li><a href="//medium.com/@sahilahuja" target="_blank" title="Medium" class="fa fa-medium"></a></li>



  <li><a href="//linkedin.com/in/ahujasahil" target="_blank" title="LinkedIn" class="fa fa-linkedin"></a></li>









  <li><a href="//facebook.com/ahujasahil" target="_blank" title="Facebook" class="fa fa-facebook"></a></li>























  <li><a href="//twitter.com/_sahilahuja" target="_blank" title="Twitter" class="fa fa-twitter"></a></li>













<li><a href="//www.quora.com/profile/sahilahuja@gmail.com" target="_blank" title="Quora" class="fa fa-quora"></a></li>






<li><a href="//flickr.com/photos/sahilahuja" target="_blank" title="Flickr" class="fa fa-flickr"></a></li>







  <li><a href="mailto:sahilahuja@gmail.com" title="Email" class="fa fa-envelope"></a></li>


      </ul>
    
  </section>

  
  <section id="recent-posts">
    <div class="mini-posts">
      <header>
        <h3>Recent Posts</h3>
      </header>
      <div class="posts-container">
        

        
          
        

        
          <article class="mini-post">
            <header>
              <h3>
                <a href="http://www.sahil.cc/post/2017/switching-from-hexo-to-hugo/">Switching From Hexo to Hugo</a>
              </h3>
              
              <time class="published" datetime='2017-10-18'>
                October 18, 2017
              </time>
            </header>
            

          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="http://www.sahil.cc/post/2017/typing-unicode-characters-in-ubuntu/">Typing Unicode Characters in Ubuntu</a>
              </h3>
              
              <time class="published" datetime='2017-08-27'>
                August 27, 2017
              </time>
            </header>
            

          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="http://www.sahil.cc/post/2017/tracking-hostname-in-google-analytics/">Tracking hostname in Google Analytics</a>
              </h3>
              
              <time class="published" datetime='2017-03-28'>
                March 28, 2017
              </time>
            </header>
            
    

    
        
        






    
    
        
    


        
        
        

        <a href="http://www.sahil.cc/post/2017/tracking-hostname-in-google-analytics/" class="image featured">
            <img src="date/google_analytics_filter.png" alt="" style='height: 100%; width: 300px; object-fit: contain; margin: auto;'>
        </a>
    


          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="http://www.sahil.cc/post/2017/to-frame-or-not-to-frame/">To Frame or Not to Frame</a>
              </h3>
              
              <time class="published" datetime='2017-03-01'>
                March 1, 2017
              </time>
            </header>
            

          </article>
        
      </div>

      
        <a href=
          
            /post/
          
        class="button">View more posts</a>
      
    </div>
  </section>

  
  
  
  
    <section id="categories">
      <header>
        <h3>
          <a href="http://www.sahil.cc/categories/">Categories</a>
        </h3>
      </header>
        
          
        

        
        <p>
          <article>
            <header>
              
                <a href="http://www.sahil.cc/categories/blog/">blog</a>
                <span style="float:right;">34</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="http://www.sahil.cc/categories/pcbo/">pcbo</a>
                <span style="float:right;">28</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="http://www.sahil.cc/categories/nitt/">nitt</a>
                <span style="float:right;">17</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="http://www.sahil.cc/categories/guide/">guide</a>
                <span style="float:right;">5</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="http://www.sahil.cc/categories/review/">review</a>
                <span style="float:right;">2</span>
              
            </header>
          </article>
        </p>
        
    </section>
  

  
  
    <section id="mini-bio">
      <h3>About</h1>
      <p>The programmer, like the poet, works only slightly removed from pure thought-stuff. He builds his castles in the air, from air, creating by exertion of the imagination.</p>
      <a href="http://www.sahil.cc/about/" class="button">Learn More</a>
    </section>
  

  
  <section id="footer">
    
      <ul class="icons">
        
        
  <li><a href="//github.com/sahil87" target="_blank" title="GitHub" class="fa fa-github"></a></li>





  <li><a href="//stackoverflow.com/users/1233476" target="_blank" title="Stack Overflow" class="fa fa-stack-overflow"></a></li>











  <li><a href="//medium.com/@sahilahuja" target="_blank" title="Medium" class="fa fa-medium"></a></li>



  <li><a href="//linkedin.com/in/ahujasahil" target="_blank" title="LinkedIn" class="fa fa-linkedin"></a></li>









  <li><a href="//facebook.com/ahujasahil" target="_blank" title="Facebook" class="fa fa-facebook"></a></li>























  <li><a href="//twitter.com/_sahilahuja" target="_blank" title="Twitter" class="fa fa-twitter"></a></li>













<li><a href="//www.quora.com/profile/sahilahuja@gmail.com" target="_blank" title="Quora" class="fa fa-quora"></a></li>






<li><a href="//flickr.com/photos/sahilahuja" target="_blank" title="Flickr" class="fa fa-flickr"></a></li>







  <li><a href="mailto:sahilahuja@gmail.com" title="Email" class="fa fa-envelope"></a></li>


      </ul>
    
    <p class="copyright">
      
        © This post is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License，please mention source if you want to quote or reproduce.
      .
      Powered by <a href="//gohugo.io" target="_blank">Hugo</a>
    </p>
  </section>
</section>

</div>
<a id="back-to-top" href="#" class="fa fa-arrow-up fa-border fa-2x"></a>



  




  <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/skel/3.0.1/skel.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.js"></script>
  <script src="http://www.sahil.cc/js/util.js"></script>
  <script src="http://www.sahil.cc/js/main.js"></script>
  <script src="http://www.sahil.cc/js/backToTop.js"></script>




      
  



<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>

